write.table(top10, "~/top10.txt")
varstats <- readRDS("~/../Downloads/var_annot.rds")
top10 <- varstats[order(varstats$median_lb_expression,decreasing=T)[1:10],]
varstats <- readRDS("~/../Downloads/var_annot.rds")
write.table(top10, "~/top10.txt")
write.table(top10, "~/top10.txt")
RVERSION
R.version()
R.Version()
setwd("~/Lab Work/Kosuri Lab/GlobalAnalysisEcoli/scripts/")
library("metagene")
temp <-
lapply(split(bed, bed$V4), function(i){
GRanges(seqnames = i$V1,
ranges = IRanges(start = i$V2,
end = i$V3,
names = i$V4))
})
setwd("~/Lab Work/Kosuri Lab/GlobalAnalysisEcoli/scripts/")
bam_files <- c("../processed_data/Plus_RNA.bam")
bed <- read.table("../ref/U00096.2_gene_only.bed",sep = "\t", header = F)
bed$V1 <- "U00096.2"
temp <-
lapply(split(bed, bed$V4), function(i){
GRanges(seqnames = i$V1,
ranges = IRanges(start = i$V2,
end = i$V3,
names = i$V4))
})
mg <- metagene$new(regions = temp,
bam_files = bam_files,
assay = 'rnaseq',
paired_end = FALSE)
